var e=(e,t,a)=>new Promise((r,o)=>{var s=e=>{try{i(a.next(e))}catch(t){o(t)}},n=e=>{try{i(a.throw(e))}catch(t){o(t)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,n);i((a=a.apply(e,t)).next())});import{a as t}from"./utils-BruBI8_W.js";t.defaults.withCredentials=!0,t.defaults.withXSRFToken=!0;const a=t.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0,withXSRFToken:!0});a.interceptors.request.use(t=>e(null,null,function*(){const e=(()=>{const e=document.cookie.match(new RegExp("(^|;\\s*)(XSRF-TOKEN)=([^;]*)"));return e?decodeURIComponent(e[3]):null})();e&&(t.headers["X-XSRF-TOKEN"]=e);const a=localStorage.getItem("token");return a&&(t.headers.Authorization=`Bearer ${a}`),t}),e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var t,a,r,o;if(window.$notify&&(null==(t=e.response)?void 0:t.status)>=400){const t=(null==(r=null==(a=e.response)?void 0:a.data)?void 0:r.message)||"An error occurred";window.$notify.error("Error",t)}return 401===(null==(o=e.response)?void 0:o.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.$notify&&window.$notify.warning("Session Expired","Please log in again"),window.location.href="/login"),Promise.reject(e)});const r={getCsrfCookie:()=>t.get("/sanctum/csrf-cookie",{withCredentials:!0}),register:t=>e(null,null,function*(){return yield r.getCsrfCookie(),a.post("/register",t)}),login:t=>e(null,null,function*(){return yield r.getCsrfCookie(),a.post("/login",t)}),logout:()=>a.post("/logout"),getUser:()=>a.get("/user"),updateProfile:e=>{const t=e instanceof FormData;return a.post("/user/profile",e,{headers:t?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"}})}},o={getAll:()=>a.get("/cars"),getById:e=>a.get(`/cars/${e}`),create:e=>a.post("/cars",e),update:(e,t)=>a.put(`/cars/${e}`,t),delete:e=>a.delete(`/cars/${e}`),statistics:()=>a.get("/cars/statistics")},s={startDiagnosis:e=>a.post("/diagnosis/start",e),submitDiagnosis:e=>a.post("/diagnosis/submit",e,{headers:{"Content-Type":"multipart/form-data"}}),getResult:e=>a.get(`/diagnosis/result/${e}?t=${Date.now()}&_=${Math.random()}`,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","If-None-Match":"*"}}),getHistory:(e={})=>a.get("/diagnosis/history",{params:e}),getCarDiagnosisHistory:(e,t={})=>a.get(`/diagnosis/car/${e}/history`,{params:t}),transcribeAudio:e=>a.post("/transcribe-audio",e,{headers:{"Content-Type":"multipart/form-data"}})},n={getStatistics:()=>a.get("/dashboard/statistics"),getNotifications:()=>a.get("/dashboard/notifications")},i={getPrimaryImage:(e,t,r=null,o=null)=>{const s={brand:e,model:t};return r&&(s.year=r),o&&(s.color=o),a.get("/car-images/primary",{params:s})},getCarImages:(e,t,r=null,o=null)=>{const s={brand:e,model:t};return r&&(s.year=r),o&&(s.color=o),a.get("/car-images/car",{params:s})},getBrandFallback:e=>a.get("/car-images/brand-fallback",{params:{brand:e}}),getDefaultImage:()=>a.get("/car-images/default")};export{i as a,a as b,o as c,s as d,r as e,n as f};
